using System;
using System.Web.UI.WebControls;

public partial class admin_Report : System.Web.UI.Page
{
    static Int32 courseKey, coursePaymentKey;
    static string strdeptISN;
    protected void Page_Load(object sender, EventArgs e)
    {
        if (Session["user"] == null || Session["access"] != "ADMIN")
        {
            Response.Redirect("../index.aspx");
        }

        if (!IsPostBack)
        {
            Session["Courseselect"] = "SELECT COURSEDETAIL.COURSE_ISN AS COURSEDETAIL_COURSE_ISN, COURSEDETAIL.COURSE_TYPE_ISN, COURSEDETAIL.COURSE_STATUS, COURSEDETAIL.DEVELOPMENT_STATUS_ISN, COURSEDETAIL.COURSE_SUBJECT, COURSEDETAIL.COURSE_NUMBER, COURSEDETAIL.COURSE_TITLE, COURSEDETAIL.COLL_CODE_ISN, COURSEDETAIL.SEMESTER_TAUGHT_ISN, COURSEDETAIL.YEAR_TAUGHT, COURSEDETAIL.DEVELOPER_ISN AS COURSEDETAIL_DEVELOPER_ISN, COURSEDETAIL.COORDINATOR_ISN, COURSEDETAIL.DATE_TO_START_REVIEW, COURSEDETAIL.QM_CERTIFIED_DATE, COURSEDETAIL.NOTE AS COURSEDETAIL_NOTE, COURSEDETAIL.ADDED_BY AS COURSEDETAIL_ADDED_BY, COURSEDETAIL.ADDED_DATE AS COURSEDETAIL_ADDED_DATE, COURSEDETAIL.UPDATED_BY AS COURSEDETAIL_UPDATED_BY, COURSEDETAIL.UPDATED_DATE AS COURSEDETAIL_UPDATED_DATE, PAYMENTPAPERWORKHISTORY.COURSE_ISN AS PAYMENTPAPERWORKHISTORY_COURSE_ISN, PAYMENTPAPERWORKHISTORY.STATEMENT_OF_INTENT, PAYMENTPAPERWORKHISTORY.PROCEDURES_AND_AGREEMENT, PAYMENTPAPERWORKHISTORY.SERVICE_CONTRACT, PAYMENTPAPERWORKHISTORY.FIRST_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.FIRST_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.SECOND_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.SECOND_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.IR_START_DATE, PAYMENTPAPERWORKHISTORY.IR_END_DATE, PAYMENTPAPERWORKHISTORY.IR_CHAIR_ISN, PAYMENTPAPERWORKHISTORY.IR_CHAIR_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.IR_CHAIR_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.IR_CHAIR_1099, PAYMENTPAPERWORKHISTORY.IR_CHAIR_1042_S, PAYMENTPAPERWORKHISTORY.IR_CHAIR_W_9, PAYMENTPAPERWORKHISTORY.IR_CHAIR_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.IR_CHAIR_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_ISN, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_1099, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_1042_S, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_W_9, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_ISN, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_1099, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_1042_S, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_W_9, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.OR_START_DATE, PAYMENTPAPERWORKHISTORY.OR_END_DATE, PAYMENTPAPERWORKHISTORY.OR_CHAIR_ISN, PAYMENTPAPERWORKHISTORY.OR_CHAIR_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.OR_CHAIR_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.OR_CHAIR_1099, PAYMENTPAPERWORKHISTORY.OR_CHAIR_1042_S, PAYMENTPAPERWORKHISTORY.OR_CHAIR_W_9, PAYMENTPAPERWORKHISTORY.OR_CHAIR_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.OR_CHAIR_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_ISN, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_1099, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_1042_S, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_W_9, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_ISN, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_1099, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_1042_S, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_W_9, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.NOTE, PAYMENTPAPERWORKHISTORY.ADDED_BY, PAYMENTPAPERWORKHISTORY.ADDED_DATE, PAYMENTPAPERWORKHISTORY.UPDATED_BY, PAYMENTPAPERWORKHISTORY.UPDATED_DATE, CODE.CODE_DESCRIPTION AS CODE_TYPE, CODE_1.CODE_DESCRIPTION AS DEVELOPMENT_STATUS, CODE_2.CODE_DESCRIPTION AS SEMESTER, CODE_3.CODE_DESCRIPTION AS COLLEGE, CODE_4.CODE_DESCRIPTION AS DEGREE, USERPROFILE.LAST_NAME + ', ' + USERPROFILE.FIRST_NAME AS DEVELOPER, USERPROFILE_1.LAST_NAME + ', ' + USERPROFILE_1.FIRST_NAME AS COORDINATOR, USERPROFILE_2.LAST_NAME + ', ' + USERPROFILE_2.FIRST_NAME AS IR_CHAIR, CODE_5.CODE_DESCRIPTION AS IR_CHAIR_CONTRACT_TYPE, USERPROFILE_3.LAST_NAME + ', ' + USERPROFILE_3.FIRST_NAME AS IR_REVIEWER2, CODE_6.CODE_DESCRIPTION AS IR_REVIEWER2_CONTRACT_TYPE, USERPROFILE_4.LAST_NAME + ', ' + USERPROFILE_4.FIRST_NAME AS IR_REVIEWER3, CODE_7.CODE_DESCRIPTION AS IR_REVIEWER3_CONTRACT_TYPE, USERPROFILE_5.LAST_NAME + ', ' + USERPROFILE_5.FIRST_NAME AS OR_CHAIR, CODE_8.CODE_DESCRIPTION AS OR_CHAIR_CONTRACT_TYPE, USERPROFILE_6.LAST_NAME + ', ' + USERPROFILE_6.FIRST_NAME AS OR_REVIEWER2, CODE_9.CODE_DESCRIPTION AS OR_REVIEWER2_CONTRACT_TYPE, USERPROFILE_7.LAST_NAME + ', ' + USERPROFILE_7.FIRST_NAME AS OR_REVIEWER3, CODE_10.CODE_DESCRIPTION AS OR_REVIEWER3_CONTRACT_TYPE, COURSEDETAIL.DEGREE_PROGRAM_CODE_ISN FROM COURSEDETAIL LEFT OUTER JOIN PAYMENTPAPERWORKHISTORY ON PAYMENTPAPERWORKHISTORY.COURSE_ISN = COURSEDETAIL.COURSE_ISN LEFT OUTER JOIN CODE ON CODE.CODE_ISN = COURSEDETAIL.COURSE_TYPE_ISN LEFT OUTER JOIN CODE AS CODE_1 ON CODE_1.CODE_ISN = COURSEDETAIL.DEVELOPMENT_STATUS_ISN LEFT OUTER JOIN CODE AS CODE_2 ON CODE_2.CODE_ISN = COURSEDETAIL.SEMESTER_TAUGHT_ISN LEFT OUTER JOIN CODE AS CODE_3 ON CODE_3.CODE_ISN = COURSEDETAIL.COLL_CODE_ISN LEFT OUTER JOIN CODE AS CODE_4 ON CODE_4.CODE_ISN = COURSEDETAIL.DEGREE_PROGRAM_CODE_ISN LEFT OUTER JOIN USERPROFILE ON USERPROFILE.USER_ISN = COURSEDETAIL.DEVELOPER_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_1 ON USERPROFILE_1.USER_ISN = COURSEDETAIL.COORDINATOR_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_2 ON USERPROFILE_2.USER_ISN = PAYMENTPAPERWORKHISTORY.IR_CHAIR_ISN LEFT OUTER JOIN CODE AS CODE_5 ON CODE_5.CODE_ISN = PAYMENTPAPERWORKHISTORY.IR_CHAIR_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_3 ON USERPROFILE_3.USER_ISN = PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_ISN LEFT OUTER JOIN CODE AS CODE_6 ON CODE_6.CODE_ISN = PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_4 ON USERPROFILE_4.USER_ISN = PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_ISN LEFT OUTER JOIN CODE AS CODE_7 ON CODE_7.CODE_ISN = PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_5 ON USERPROFILE_5.USER_ISN = PAYMENTPAPERWORKHISTORY.OR_CHAIR_ISN LEFT OUTER JOIN CODE AS CODE_8 ON CODE_8.CODE_ISN = PAYMENTPAPERWORKHISTORY.OR_CHAIR_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_6 ON USERPROFILE_6.USER_ISN = PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_ISN LEFT OUTER JOIN CODE AS CODE_9 ON CODE_9.CODE_ISN = PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_7 ON USERPROFILE_7.USER_ISN = PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_ISN LEFT OUTER JOIN CODE AS CODE_10 ON CODE_10.CODE_ISN = PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_CONTRACT_TYPE_ISN ORDER BY COURSEDETAIL.DEVELOPMENT_STATUS_ISN, COURSEDETAIL.COURSE_SUBJECT, COURSEDETAIL.COURSE_NUMBER";
            SqlCourseDetail.SelectCommand = (string)Session["Courseselect"];
            SqlCourseDetail.DataBind();
        }

        if (IsPostBack)
        {
            SqlCourseDetail.SelectCommand = (string)Session["Courseselect"];
            SqlCourseDetail.DataBind();
        }

       

    }
    
    protected void lnkLogout_Click(object sender, EventArgs e)
    {
        Session.Clear();
        Session.Abandon();
        Session.RemoveAll();
        Response.Redirect("../index.aspx");
    }

    

    protected void btnCourseClear_Click(object sender, EventArgs e)
    {
        Session["Courseselect"] = "SELECT COURSEDETAIL.COURSE_ISN AS COURSEDETAIL_COURSE_ISN, COURSEDETAIL.COURSE_TYPE_ISN, COURSEDETAIL.COURSE_STATUS, COURSEDETAIL.DEVELOPMENT_STATUS_ISN, COURSEDETAIL.COURSE_SUBJECT, COURSEDETAIL.COURSE_NUMBER, COURSEDETAIL.COURSE_TITLE, COURSEDETAIL.COLL_CODE_ISN, COURSEDETAIL.SEMESTER_TAUGHT_ISN, COURSEDETAIL.YEAR_TAUGHT, COURSEDETAIL.DEVELOPER_ISN AS COURSEDETAIL_DEVELOPER_ISN, COURSEDETAIL.COORDINATOR_ISN, COURSEDETAIL.DATE_TO_START_REVIEW, COURSEDETAIL.QM_CERTIFIED_DATE, COURSEDETAIL.NOTE AS COURSEDETAIL_NOTE, COURSEDETAIL.ADDED_BY AS COURSEDETAIL_ADDED_BY, COURSEDETAIL.ADDED_DATE AS COURSEDETAIL_ADDED_DATE, COURSEDETAIL.UPDATED_BY AS COURSEDETAIL_UPDATED_BY, COURSEDETAIL.UPDATED_DATE AS COURSEDETAIL_UPDATED_DATE, PAYMENTPAPERWORKHISTORY.COURSE_ISN AS PAYMENTPAPERWORKHISTORY_COURSE_ISN, PAYMENTPAPERWORKHISTORY.STATEMENT_OF_INTENT, PAYMENTPAPERWORKHISTORY.PROCEDURES_AND_AGREEMENT, PAYMENTPAPERWORKHISTORY.SERVICE_CONTRACT, PAYMENTPAPERWORKHISTORY.FIRST_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.FIRST_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.SECOND_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.SECOND_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.IR_START_DATE, PAYMENTPAPERWORKHISTORY.IR_END_DATE, PAYMENTPAPERWORKHISTORY.IR_CHAIR_ISN, PAYMENTPAPERWORKHISTORY.IR_CHAIR_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.IR_CHAIR_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.IR_CHAIR_1099, PAYMENTPAPERWORKHISTORY.IR_CHAIR_1042_S, PAYMENTPAPERWORKHISTORY.IR_CHAIR_W_9, PAYMENTPAPERWORKHISTORY.IR_CHAIR_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.IR_CHAIR_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_ISN, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_1099, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_1042_S, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_W_9, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_ISN, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_1099, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_1042_S, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_W_9, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.OR_START_DATE, PAYMENTPAPERWORKHISTORY.OR_END_DATE, PAYMENTPAPERWORKHISTORY.OR_CHAIR_ISN, PAYMENTPAPERWORKHISTORY.OR_CHAIR_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.OR_CHAIR_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.OR_CHAIR_1099, PAYMENTPAPERWORKHISTORY.OR_CHAIR_1042_S, PAYMENTPAPERWORKHISTORY.OR_CHAIR_W_9, PAYMENTPAPERWORKHISTORY.OR_CHAIR_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.OR_CHAIR_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_ISN, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_1099, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_1042_S, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_W_9, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_ISN, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_1099, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_1042_S, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_W_9, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.NOTE, PAYMENTPAPERWORKHISTORY.ADDED_BY, PAYMENTPAPERWORKHISTORY.ADDED_DATE, PAYMENTPAPERWORKHISTORY.UPDATED_BY, PAYMENTPAPERWORKHISTORY.UPDATED_DATE, CODE.CODE_DESCRIPTION AS CODE_TYPE, CODE_1.CODE_DESCRIPTION AS DEVELOPMENT_STATUS, CODE_2.CODE_DESCRIPTION AS SEMESTER, CODE_3.CODE_DESCRIPTION AS COLLEGE, CODE_4.CODE_DESCRIPTION AS DEGREE, USERPROFILE.LAST_NAME + ', ' + USERPROFILE.FIRST_NAME AS DEVELOPER, USERPROFILE_1.LAST_NAME + ', ' + USERPROFILE_1.FIRST_NAME AS COORDINATOR, USERPROFILE_2.LAST_NAME + ', ' + USERPROFILE_2.FIRST_NAME AS IR_CHAIR, CODE_5.CODE_DESCRIPTION AS IR_CHAIR_CONTRACT_TYPE, USERPROFILE_3.LAST_NAME + ', ' + USERPROFILE_3.FIRST_NAME AS IR_REVIEWER2, CODE_6.CODE_DESCRIPTION AS IR_REVIEWER2_CONTRACT_TYPE, USERPROFILE_4.LAST_NAME + ', ' + USERPROFILE_4.FIRST_NAME AS IR_REVIEWER3, CODE_7.CODE_DESCRIPTION AS IR_REVIEWER3_CONTRACT_TYPE, USERPROFILE_5.LAST_NAME + ', ' + USERPROFILE_5.FIRST_NAME AS OR_CHAIR, CODE_8.CODE_DESCRIPTION AS OR_CHAIR_CONTRACT_TYPE, USERPROFILE_6.LAST_NAME + ', ' + USERPROFILE_6.FIRST_NAME AS OR_REVIEWER2, CODE_9.CODE_DESCRIPTION AS OR_REVIEWER2_CONTRACT_TYPE, USERPROFILE_7.LAST_NAME + ', ' + USERPROFILE_7.FIRST_NAME AS OR_REVIEWER3, CODE_10.CODE_DESCRIPTION AS OR_REVIEWER3_CONTRACT_TYPE, COURSEDETAIL.DEGREE_PROGRAM_CODE_ISN FROM COURSEDETAIL LEFT OUTER JOIN PAYMENTPAPERWORKHISTORY ON PAYMENTPAPERWORKHISTORY.COURSE_ISN = COURSEDETAIL.COURSE_ISN LEFT OUTER JOIN CODE ON CODE.CODE_ISN = COURSEDETAIL.COURSE_TYPE_ISN LEFT OUTER JOIN CODE AS CODE_1 ON CODE_1.CODE_ISN = COURSEDETAIL.DEVELOPMENT_STATUS_ISN LEFT OUTER JOIN CODE AS CODE_2 ON CODE_2.CODE_ISN = COURSEDETAIL.SEMESTER_TAUGHT_ISN LEFT OUTER JOIN CODE AS CODE_3 ON CODE_3.CODE_ISN = COURSEDETAIL.COLL_CODE_ISN LEFT OUTER JOIN CODE AS CODE_4 ON CODE_4.CODE_ISN = COURSEDETAIL.DEGREE_PROGRAM_CODE_ISN LEFT OUTER JOIN USERPROFILE ON USERPROFILE.USER_ISN = COURSEDETAIL.DEVELOPER_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_1 ON USERPROFILE_1.USER_ISN = COURSEDETAIL.COORDINATOR_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_2 ON USERPROFILE_2.USER_ISN = PAYMENTPAPERWORKHISTORY.IR_CHAIR_ISN LEFT OUTER JOIN CODE AS CODE_5 ON CODE_5.CODE_ISN = PAYMENTPAPERWORKHISTORY.IR_CHAIR_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_3 ON USERPROFILE_3.USER_ISN = PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_ISN LEFT OUTER JOIN CODE AS CODE_6 ON CODE_6.CODE_ISN = PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_4 ON USERPROFILE_4.USER_ISN = PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_ISN LEFT OUTER JOIN CODE AS CODE_7 ON CODE_7.CODE_ISN = PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_5 ON USERPROFILE_5.USER_ISN = PAYMENTPAPERWORKHISTORY.OR_CHAIR_ISN LEFT OUTER JOIN CODE AS CODE_8 ON CODE_8.CODE_ISN = PAYMENTPAPERWORKHISTORY.OR_CHAIR_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_6 ON USERPROFILE_6.USER_ISN = PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_ISN LEFT OUTER JOIN CODE AS CODE_9 ON CODE_9.CODE_ISN = PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_7 ON USERPROFILE_7.USER_ISN = PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_ISN LEFT OUTER JOIN CODE AS CODE_10 ON CODE_10.CODE_ISN = PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_CONTRACT_TYPE_ISN ORDER BY COURSEDETAIL.DEVELOPMENT_STATUS_ISN, COURSEDETAIL.COURSE_SUBJECT, COURSEDETAIL.COURSE_NUMBER";
        SqlCourseDetail.SelectCommand = (string)Session["Courseselect"];
        SqlCourseDetail.DataBind();
        CollegeSearch.SelectedIndex = -1;
        ProgramSearch.SelectedIndex = -1;
        ProgramSearch.Enabled = false;
    }
   
    protected void btnCourseSearch_Click(object sender, EventArgs e)
    {
        if (Session["user"] == null || Session["access"] != "ADMIN")
        {
            Response.Redirect("../index.aspx");
        }
        
        if (CollegeSearch.SelectedValue == "-1")
        {
            Session["Courseselect"] = "SELECT COURSEDETAIL.COURSE_ISN AS COURSEDETAIL_COURSE_ISN, COURSEDETAIL.COURSE_TYPE_ISN, COURSEDETAIL.COURSE_STATUS, COURSEDETAIL.DEVELOPMENT_STATUS_ISN, COURSEDETAIL.COURSE_SUBJECT, COURSEDETAIL.COURSE_NUMBER, COURSEDETAIL.COURSE_TITLE, COURSEDETAIL.COLL_CODE_ISN, COURSEDETAIL.SEMESTER_TAUGHT_ISN, COURSEDETAIL.YEAR_TAUGHT, COURSEDETAIL.DEVELOPER_ISN AS COURSEDETAIL_DEVELOPER_ISN, COURSEDETAIL.COORDINATOR_ISN, COURSEDETAIL.DATE_TO_START_REVIEW, COURSEDETAIL.QM_CERTIFIED_DATE, COURSEDETAIL.NOTE AS COURSEDETAIL_NOTE, COURSEDETAIL.ADDED_BY AS COURSEDETAIL_ADDED_BY, COURSEDETAIL.ADDED_DATE AS COURSEDETAIL_ADDED_DATE, COURSEDETAIL.UPDATED_BY AS COURSEDETAIL_UPDATED_BY, COURSEDETAIL.UPDATED_DATE AS COURSEDETAIL_UPDATED_DATE, PAYMENTPAPERWORKHISTORY.COURSE_ISN AS PAYMENTPAPERWORKHISTORY_COURSE_ISN, PAYMENTPAPERWORKHISTORY.STATEMENT_OF_INTENT, PAYMENTPAPERWORKHISTORY.PROCEDURES_AND_AGREEMENT, PAYMENTPAPERWORKHISTORY.SERVICE_CONTRACT, PAYMENTPAPERWORKHISTORY.FIRST_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.FIRST_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.SECOND_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.SECOND_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.IR_START_DATE, PAYMENTPAPERWORKHISTORY.IR_END_DATE, PAYMENTPAPERWORKHISTORY.IR_CHAIR_ISN, PAYMENTPAPERWORKHISTORY.IR_CHAIR_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.IR_CHAIR_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.IR_CHAIR_1099, PAYMENTPAPERWORKHISTORY.IR_CHAIR_1042_S, PAYMENTPAPERWORKHISTORY.IR_CHAIR_W_9, PAYMENTPAPERWORKHISTORY.IR_CHAIR_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.IR_CHAIR_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_ISN, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_1099, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_1042_S, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_W_9, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_ISN, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_1099, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_1042_S, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_W_9, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.OR_START_DATE, PAYMENTPAPERWORKHISTORY.OR_END_DATE, PAYMENTPAPERWORKHISTORY.OR_CHAIR_ISN, PAYMENTPAPERWORKHISTORY.OR_CHAIR_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.OR_CHAIR_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.OR_CHAIR_1099, PAYMENTPAPERWORKHISTORY.OR_CHAIR_1042_S, PAYMENTPAPERWORKHISTORY.OR_CHAIR_W_9, PAYMENTPAPERWORKHISTORY.OR_CHAIR_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.OR_CHAIR_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_ISN, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_1099, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_1042_S, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_W_9, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_ISN, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_1099, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_1042_S, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_W_9, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.NOTE, PAYMENTPAPERWORKHISTORY.ADDED_BY, PAYMENTPAPERWORKHISTORY.ADDED_DATE, PAYMENTPAPERWORKHISTORY.UPDATED_BY, PAYMENTPAPERWORKHISTORY.UPDATED_DATE, CODE.CODE_DESCRIPTION AS CODE_TYPE, CODE_1.CODE_DESCRIPTION AS DEVELOPMENT_STATUS, CODE_2.CODE_DESCRIPTION AS SEMESTER, CODE_3.CODE_DESCRIPTION AS COLLEGE, CODE_4.CODE_DESCRIPTION AS DEGREE, USERPROFILE.LAST_NAME + ', ' + USERPROFILE.FIRST_NAME AS DEVELOPER, USERPROFILE_1.LAST_NAME + ', ' + USERPROFILE_1.FIRST_NAME AS COORDINATOR, USERPROFILE_2.LAST_NAME + ', ' + USERPROFILE_2.FIRST_NAME AS IR_CHAIR, CODE_5.CODE_DESCRIPTION AS IR_CHAIR_CONTRACT_TYPE, USERPROFILE_3.LAST_NAME + ', ' + USERPROFILE_3.FIRST_NAME AS IR_REVIEWER2, CODE_6.CODE_DESCRIPTION AS IR_REVIEWER2_CONTRACT_TYPE, USERPROFILE_4.LAST_NAME + ', ' + USERPROFILE_4.FIRST_NAME AS IR_REVIEWER3, CODE_7.CODE_DESCRIPTION AS IR_REVIEWER3_CONTRACT_TYPE, USERPROFILE_5.LAST_NAME + ', ' + USERPROFILE_5.FIRST_NAME AS OR_CHAIR, CODE_8.CODE_DESCRIPTION AS OR_CHAIR_CONTRACT_TYPE, USERPROFILE_6.LAST_NAME + ', ' + USERPROFILE_6.FIRST_NAME AS OR_REVIEWER2, CODE_9.CODE_DESCRIPTION AS OR_REVIEWER2_CONTRACT_TYPE, USERPROFILE_7.LAST_NAME + ', ' + USERPROFILE_7.FIRST_NAME AS OR_REVIEWER3, CODE_10.CODE_DESCRIPTION AS OR_REVIEWER3_CONTRACT_TYPE, COURSEDETAIL.DEGREE_PROGRAM_CODE_ISN FROM COURSEDETAIL LEFT OUTER JOIN PAYMENTPAPERWORKHISTORY ON PAYMENTPAPERWORKHISTORY.COURSE_ISN = COURSEDETAIL.COURSE_ISN LEFT OUTER JOIN CODE ON CODE.CODE_ISN = COURSEDETAIL.COURSE_TYPE_ISN LEFT OUTER JOIN CODE AS CODE_1 ON CODE_1.CODE_ISN = COURSEDETAIL.DEVELOPMENT_STATUS_ISN LEFT OUTER JOIN CODE AS CODE_2 ON CODE_2.CODE_ISN = COURSEDETAIL.SEMESTER_TAUGHT_ISN LEFT OUTER JOIN CODE AS CODE_3 ON CODE_3.CODE_ISN = COURSEDETAIL.COLL_CODE_ISN LEFT OUTER JOIN CODE AS CODE_4 ON CODE_4.CODE_ISN = COURSEDETAIL.DEGREE_PROGRAM_CODE_ISN LEFT OUTER JOIN USERPROFILE ON USERPROFILE.USER_ISN = COURSEDETAIL.DEVELOPER_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_1 ON USERPROFILE_1.USER_ISN = COURSEDETAIL.COORDINATOR_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_2 ON USERPROFILE_2.USER_ISN = PAYMENTPAPERWORKHISTORY.IR_CHAIR_ISN LEFT OUTER JOIN CODE AS CODE_5 ON CODE_5.CODE_ISN = PAYMENTPAPERWORKHISTORY.IR_CHAIR_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_3 ON USERPROFILE_3.USER_ISN = PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_ISN LEFT OUTER JOIN CODE AS CODE_6 ON CODE_6.CODE_ISN = PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_4 ON USERPROFILE_4.USER_ISN = PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_ISN LEFT OUTER JOIN CODE AS CODE_7 ON CODE_7.CODE_ISN = PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_5 ON USERPROFILE_5.USER_ISN = PAYMENTPAPERWORKHISTORY.OR_CHAIR_ISN LEFT OUTER JOIN CODE AS CODE_8 ON CODE_8.CODE_ISN = PAYMENTPAPERWORKHISTORY.OR_CHAIR_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_6 ON USERPROFILE_6.USER_ISN = PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_ISN LEFT OUTER JOIN CODE AS CODE_9 ON CODE_9.CODE_ISN = PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_7 ON USERPROFILE_7.USER_ISN = PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_ISN LEFT OUTER JOIN CODE AS CODE_10 ON CODE_10.CODE_ISN = PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_CONTRACT_TYPE_ISN ORDER BY COURSEDETAIL.DEVELOPMENT_STATUS_ISN, COURSEDETAIL.COURSE_SUBJECT, COURSEDETAIL.COURSE_NUMBER";
            SqlCourseDetail.SelectCommand = (string)Session["Courseselect"];
            SqlCourseDetail.DataBind();
        }
        else if (CollegeSearch.SelectedValue != "-1" && ProgramSearch.SelectedValue == "-1")
        {
            Session["Courseselect"] = "SELECT COURSEDETAIL.COURSE_ISN AS COURSEDETAIL_COURSE_ISN, COURSEDETAIL.COURSE_TYPE_ISN, COURSEDETAIL.COURSE_STATUS, COURSEDETAIL.DEVELOPMENT_STATUS_ISN, COURSEDETAIL.COURSE_SUBJECT, COURSEDETAIL.COURSE_NUMBER, COURSEDETAIL.COURSE_TITLE, COURSEDETAIL.COLL_CODE_ISN, COURSEDETAIL.SEMESTER_TAUGHT_ISN, COURSEDETAIL.YEAR_TAUGHT, COURSEDETAIL.DEVELOPER_ISN AS COURSEDETAIL_DEVELOPER_ISN, COURSEDETAIL.COORDINATOR_ISN, COURSEDETAIL.DATE_TO_START_REVIEW, COURSEDETAIL.QM_CERTIFIED_DATE, COURSEDETAIL.NOTE AS COURSEDETAIL_NOTE, COURSEDETAIL.ADDED_BY AS COURSEDETAIL_ADDED_BY, COURSEDETAIL.ADDED_DATE AS COURSEDETAIL_ADDED_DATE, COURSEDETAIL.UPDATED_BY AS COURSEDETAIL_UPDATED_BY, COURSEDETAIL.UPDATED_DATE AS COURSEDETAIL_UPDATED_DATE, PAYMENTPAPERWORKHISTORY.COURSE_ISN AS PAYMENTPAPERWORKHISTORY_COURSE_ISN, PAYMENTPAPERWORKHISTORY.STATEMENT_OF_INTENT, PAYMENTPAPERWORKHISTORY.PROCEDURES_AND_AGREEMENT, PAYMENTPAPERWORKHISTORY.SERVICE_CONTRACT, PAYMENTPAPERWORKHISTORY.FIRST_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.FIRST_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.SECOND_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.SECOND_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.IR_START_DATE, PAYMENTPAPERWORKHISTORY.IR_END_DATE, PAYMENTPAPERWORKHISTORY.IR_CHAIR_ISN, PAYMENTPAPERWORKHISTORY.IR_CHAIR_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.IR_CHAIR_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.IR_CHAIR_1099, PAYMENTPAPERWORKHISTORY.IR_CHAIR_1042_S, PAYMENTPAPERWORKHISTORY.IR_CHAIR_W_9, PAYMENTPAPERWORKHISTORY.IR_CHAIR_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.IR_CHAIR_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_ISN, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_1099, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_1042_S, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_W_9, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_ISN, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_1099, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_1042_S, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_W_9, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.OR_START_DATE, PAYMENTPAPERWORKHISTORY.OR_END_DATE, PAYMENTPAPERWORKHISTORY.OR_CHAIR_ISN, PAYMENTPAPERWORKHISTORY.OR_CHAIR_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.OR_CHAIR_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.OR_CHAIR_1099, PAYMENTPAPERWORKHISTORY.OR_CHAIR_1042_S, PAYMENTPAPERWORKHISTORY.OR_CHAIR_W_9, PAYMENTPAPERWORKHISTORY.OR_CHAIR_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.OR_CHAIR_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_ISN, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_1099, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_1042_S, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_W_9, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_ISN, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_1099, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_1042_S, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_W_9, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.NOTE, PAYMENTPAPERWORKHISTORY.ADDED_BY, PAYMENTPAPERWORKHISTORY.ADDED_DATE, PAYMENTPAPERWORKHISTORY.UPDATED_BY, PAYMENTPAPERWORKHISTORY.UPDATED_DATE, CODE.CODE_DESCRIPTION AS CODE_TYPE, CODE_1.CODE_DESCRIPTION AS DEVELOPMENT_STATUS, CODE_2.CODE_DESCRIPTION AS SEMESTER, CODE_3.CODE_DESCRIPTION AS COLLEGE, CODE_4.CODE_DESCRIPTION AS DEGREE, USERPROFILE.LAST_NAME + ', ' + USERPROFILE.FIRST_NAME AS DEVELOPER, USERPROFILE_1.LAST_NAME + ', ' + USERPROFILE_1.FIRST_NAME AS COORDINATOR, USERPROFILE_2.LAST_NAME + ', ' + USERPROFILE_2.FIRST_NAME AS IR_CHAIR, CODE_5.CODE_DESCRIPTION AS IR_CHAIR_CONTRACT_TYPE, USERPROFILE_3.LAST_NAME + ', ' + USERPROFILE_3.FIRST_NAME AS IR_REVIEWER2, CODE_6.CODE_DESCRIPTION AS IR_REVIEWER2_CONTRACT_TYPE, USERPROFILE_4.LAST_NAME + ', ' + USERPROFILE_4.FIRST_NAME AS IR_REVIEWER3, CODE_7.CODE_DESCRIPTION AS IR_REVIEWER3_CONTRACT_TYPE, USERPROFILE_5.LAST_NAME + ', ' + USERPROFILE_5.FIRST_NAME AS OR_CHAIR, CODE_8.CODE_DESCRIPTION AS OR_CHAIR_CONTRACT_TYPE, USERPROFILE_6.LAST_NAME + ', ' + USERPROFILE_6.FIRST_NAME AS OR_REVIEWER2, CODE_9.CODE_DESCRIPTION AS OR_REVIEWER2_CONTRACT_TYPE, USERPROFILE_7.LAST_NAME + ', ' + USERPROFILE_7.FIRST_NAME AS OR_REVIEWER3, CODE_10.CODE_DESCRIPTION AS OR_REVIEWER3_CONTRACT_TYPE, COURSEDETAIL.DEGREE_PROGRAM_CODE_ISN FROM COURSEDETAIL LEFT OUTER JOIN PAYMENTPAPERWORKHISTORY ON PAYMENTPAPERWORKHISTORY.COURSE_ISN = COURSEDETAIL.COURSE_ISN LEFT OUTER JOIN CODE ON CODE.CODE_ISN = COURSEDETAIL.COURSE_TYPE_ISN LEFT OUTER JOIN CODE AS CODE_1 ON CODE_1.CODE_ISN = COURSEDETAIL.DEVELOPMENT_STATUS_ISN LEFT OUTER JOIN CODE AS CODE_2 ON CODE_2.CODE_ISN = COURSEDETAIL.SEMESTER_TAUGHT_ISN LEFT OUTER JOIN CODE AS CODE_3 ON CODE_3.CODE_ISN = COURSEDETAIL.COLL_CODE_ISN LEFT OUTER JOIN CODE AS CODE_4 ON CODE_4.CODE_ISN = COURSEDETAIL.DEGREE_PROGRAM_CODE_ISN LEFT OUTER JOIN USERPROFILE ON USERPROFILE.USER_ISN = COURSEDETAIL.DEVELOPER_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_1 ON USERPROFILE_1.USER_ISN = COURSEDETAIL.COORDINATOR_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_2 ON USERPROFILE_2.USER_ISN = PAYMENTPAPERWORKHISTORY.IR_CHAIR_ISN LEFT OUTER JOIN CODE AS CODE_5 ON CODE_5.CODE_ISN = PAYMENTPAPERWORKHISTORY.IR_CHAIR_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_3 ON USERPROFILE_3.USER_ISN = PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_ISN LEFT OUTER JOIN CODE AS CODE_6 ON CODE_6.CODE_ISN = PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_4 ON USERPROFILE_4.USER_ISN = PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_ISN LEFT OUTER JOIN CODE AS CODE_7 ON CODE_7.CODE_ISN = PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_5 ON USERPROFILE_5.USER_ISN = PAYMENTPAPERWORKHISTORY.OR_CHAIR_ISN LEFT OUTER JOIN CODE AS CODE_8 ON CODE_8.CODE_ISN = PAYMENTPAPERWORKHISTORY.OR_CHAIR_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_6 ON USERPROFILE_6.USER_ISN = PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_ISN LEFT OUTER JOIN CODE AS CODE_9 ON CODE_9.CODE_ISN = PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_7 ON USERPROFILE_7.USER_ISN = PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_ISN LEFT OUTER JOIN CODE AS CODE_10 ON CODE_10.CODE_ISN = PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_CONTRACT_TYPE_ISN  where Coursedetail.COLL_CODE_ISN ='" + CollegeSearch.SelectedValue + "' ORDER BY COURSEDETAIL.DEVELOPMENT_STATUS_ISN, COURSEDETAIL.COURSE_SUBJECT, COURSEDETAIL.COURSE_NUMBER";
            SqlCourseDetail.SelectCommand = (string)Session["Courseselect"];
            SqlCourseDetail.DataBind();
        }
        else if (CollegeSearch.SelectedValue != "-1" && ProgramSearch.SelectedValue != "-1")
        {
            Session["Courseselect"] = "SELECT COURSEDETAIL.COURSE_ISN AS COURSEDETAIL_COURSE_ISN, COURSEDETAIL.COURSE_TYPE_ISN, COURSEDETAIL.COURSE_STATUS, COURSEDETAIL.DEVELOPMENT_STATUS_ISN, COURSEDETAIL.COURSE_SUBJECT, COURSEDETAIL.COURSE_NUMBER, COURSEDETAIL.COURSE_TITLE, COURSEDETAIL.COLL_CODE_ISN, COURSEDETAIL.SEMESTER_TAUGHT_ISN, COURSEDETAIL.YEAR_TAUGHT, COURSEDETAIL.DEVELOPER_ISN AS COURSEDETAIL_DEVELOPER_ISN, COURSEDETAIL.COORDINATOR_ISN, COURSEDETAIL.DATE_TO_START_REVIEW, COURSEDETAIL.QM_CERTIFIED_DATE, COURSEDETAIL.NOTE AS COURSEDETAIL_NOTE, COURSEDETAIL.ADDED_BY AS COURSEDETAIL_ADDED_BY, COURSEDETAIL.ADDED_DATE AS COURSEDETAIL_ADDED_DATE, COURSEDETAIL.UPDATED_BY AS COURSEDETAIL_UPDATED_BY, COURSEDETAIL.UPDATED_DATE AS COURSEDETAIL_UPDATED_DATE, PAYMENTPAPERWORKHISTORY.COURSE_ISN AS PAYMENTPAPERWORKHISTORY_COURSE_ISN, PAYMENTPAPERWORKHISTORY.STATEMENT_OF_INTENT, PAYMENTPAPERWORKHISTORY.PROCEDURES_AND_AGREEMENT, PAYMENTPAPERWORKHISTORY.SERVICE_CONTRACT, PAYMENTPAPERWORKHISTORY.FIRST_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.FIRST_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.SECOND_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.SECOND_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.IR_START_DATE, PAYMENTPAPERWORKHISTORY.IR_END_DATE, PAYMENTPAPERWORKHISTORY.IR_CHAIR_ISN, PAYMENTPAPERWORKHISTORY.IR_CHAIR_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.IR_CHAIR_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.IR_CHAIR_1099, PAYMENTPAPERWORKHISTORY.IR_CHAIR_1042_S, PAYMENTPAPERWORKHISTORY.IR_CHAIR_W_9, PAYMENTPAPERWORKHISTORY.IR_CHAIR_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.IR_CHAIR_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_ISN, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_1099, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_1042_S, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_W_9, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_ISN, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_1099, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_1042_S, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_W_9, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.OR_START_DATE, PAYMENTPAPERWORKHISTORY.OR_END_DATE, PAYMENTPAPERWORKHISTORY.OR_CHAIR_ISN, PAYMENTPAPERWORKHISTORY.OR_CHAIR_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.OR_CHAIR_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.OR_CHAIR_1099, PAYMENTPAPERWORKHISTORY.OR_CHAIR_1042_S, PAYMENTPAPERWORKHISTORY.OR_CHAIR_W_9, PAYMENTPAPERWORKHISTORY.OR_CHAIR_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.OR_CHAIR_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_ISN, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_1099, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_1042_S, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_W_9, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_ISN, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_CONTRACT_TYPE_ISN, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_SUPPLEMENT_PAYROLL_FORM, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_1099, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_1042_S, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_W_9, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_PAYMENT_AMOUNT, PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_ESTIMATED_PAYMENT_DATE, PAYMENTPAPERWORKHISTORY.NOTE, PAYMENTPAPERWORKHISTORY.ADDED_BY, PAYMENTPAPERWORKHISTORY.ADDED_DATE, PAYMENTPAPERWORKHISTORY.UPDATED_BY, PAYMENTPAPERWORKHISTORY.UPDATED_DATE, CODE.CODE_DESCRIPTION AS CODE_TYPE, CODE_1.CODE_DESCRIPTION AS DEVELOPMENT_STATUS, CODE_2.CODE_DESCRIPTION AS SEMESTER, CODE_3.CODE_DESCRIPTION AS COLLEGE, CODE_4.CODE_DESCRIPTION AS DEGREE, USERPROFILE.LAST_NAME + ', ' + USERPROFILE.FIRST_NAME AS DEVELOPER, USERPROFILE_1.LAST_NAME + ', ' + USERPROFILE_1.FIRST_NAME AS COORDINATOR, USERPROFILE_2.LAST_NAME + ', ' + USERPROFILE_2.FIRST_NAME AS IR_CHAIR, CODE_5.CODE_DESCRIPTION AS IR_CHAIR_CONTRACT_TYPE, USERPROFILE_3.LAST_NAME + ', ' + USERPROFILE_3.FIRST_NAME AS IR_REVIEWER2, CODE_6.CODE_DESCRIPTION AS IR_REVIEWER2_CONTRACT_TYPE, USERPROFILE_4.LAST_NAME + ', ' + USERPROFILE_4.FIRST_NAME AS IR_REVIEWER3, CODE_7.CODE_DESCRIPTION AS IR_REVIEWER3_CONTRACT_TYPE, USERPROFILE_5.LAST_NAME + ', ' + USERPROFILE_5.FIRST_NAME AS OR_CHAIR, CODE_8.CODE_DESCRIPTION AS OR_CHAIR_CONTRACT_TYPE, USERPROFILE_6.LAST_NAME + ', ' + USERPROFILE_6.FIRST_NAME AS OR_REVIEWER2, CODE_9.CODE_DESCRIPTION AS OR_REVIEWER2_CONTRACT_TYPE, USERPROFILE_7.LAST_NAME + ', ' + USERPROFILE_7.FIRST_NAME AS OR_REVIEWER3, CODE_10.CODE_DESCRIPTION AS OR_REVIEWER3_CONTRACT_TYPE, COURSEDETAIL.DEGREE_PROGRAM_CODE_ISN FROM COURSEDETAIL LEFT OUTER JOIN PAYMENTPAPERWORKHISTORY ON PAYMENTPAPERWORKHISTORY.COURSE_ISN = COURSEDETAIL.COURSE_ISN LEFT OUTER JOIN CODE ON CODE.CODE_ISN = COURSEDETAIL.COURSE_TYPE_ISN LEFT OUTER JOIN CODE AS CODE_1 ON CODE_1.CODE_ISN = COURSEDETAIL.DEVELOPMENT_STATUS_ISN LEFT OUTER JOIN CODE AS CODE_2 ON CODE_2.CODE_ISN = COURSEDETAIL.SEMESTER_TAUGHT_ISN LEFT OUTER JOIN CODE AS CODE_3 ON CODE_3.CODE_ISN = COURSEDETAIL.COLL_CODE_ISN LEFT OUTER JOIN CODE AS CODE_4 ON CODE_4.CODE_ISN = COURSEDETAIL.DEGREE_PROGRAM_CODE_ISN LEFT OUTER JOIN USERPROFILE ON USERPROFILE.USER_ISN = COURSEDETAIL.DEVELOPER_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_1 ON USERPROFILE_1.USER_ISN = COURSEDETAIL.COORDINATOR_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_2 ON USERPROFILE_2.USER_ISN = PAYMENTPAPERWORKHISTORY.IR_CHAIR_ISN LEFT OUTER JOIN CODE AS CODE_5 ON CODE_5.CODE_ISN = PAYMENTPAPERWORKHISTORY.IR_CHAIR_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_3 ON USERPROFILE_3.USER_ISN = PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_ISN LEFT OUTER JOIN CODE AS CODE_6 ON CODE_6.CODE_ISN = PAYMENTPAPERWORKHISTORY.IR_REVIEWER2_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_4 ON USERPROFILE_4.USER_ISN = PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_ISN LEFT OUTER JOIN CODE AS CODE_7 ON CODE_7.CODE_ISN = PAYMENTPAPERWORKHISTORY.IR_REVIEWER3_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_5 ON USERPROFILE_5.USER_ISN = PAYMENTPAPERWORKHISTORY.OR_CHAIR_ISN LEFT OUTER JOIN CODE AS CODE_8 ON CODE_8.CODE_ISN = PAYMENTPAPERWORKHISTORY.OR_CHAIR_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_6 ON USERPROFILE_6.USER_ISN = PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_ISN LEFT OUTER JOIN CODE AS CODE_9 ON CODE_9.CODE_ISN = PAYMENTPAPERWORKHISTORY.OR_REVIEWER2_CONTRACT_TYPE_ISN LEFT OUTER JOIN USERPROFILE AS USERPROFILE_7 ON USERPROFILE_7.USER_ISN = PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_ISN LEFT OUTER JOIN CODE AS CODE_10 ON CODE_10.CODE_ISN = PAYMENTPAPERWORKHISTORY.OR_REVIEWER3_CONTRACT_TYPE_ISN  where Coursedetail.COLL_CODE_ISN ='" + CollegeSearch.SelectedValue + "' AND COURSEDETAIL.DEGREE_PROGRAM_CODE_ISN ='" + ProgramSearch.SelectedValue + "' ORDER BY COURSEDETAIL.DEVELOPMENT_STATUS_ISN, COURSEDETAIL.COURSE_SUBJECT, COURSEDETAIL.COURSE_NUMBER";
            SqlCourseDetail.SelectCommand = (string)Session["Courseselect"];
            SqlCollegeDetails.DataBind();
        }
        gvCourseDetail.DataBind();
    }

    protected void SqlCourseSearch_Selected(object sender, SqlDataSourceStatusEventArgs e)
    {
        totalCourseValue.Text = e.AffectedRows.ToString();
    }


       protected void CollegeSearch_SelectedIndexChanged(object sender, EventArgs e)
    {
        ProgramSearch.Enabled = true;
    }
}